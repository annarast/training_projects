**Описание задачи**  

1. Cобрать аналитическую информацию для маркетологов компании (оператор связи).
2. Построить модель машинного обучения, позволяющую на основе персональных данных клиента прогнозировать его намерение отказаться от услуг компании.
Требования к модели: значение метрики ROC AUC на тестовой выборке не менее 0.85.   

**Источник данных** 

Компания: оператор свяхи, предоставляющий услуги стационарной телефонной связи (одна и несколько линий) и интернета (DSL и Fiber optic), а также набор дополнительных услуг (интернет-безопасность, техническая поддержка, облачное хранилище файлов для резервного копирования данных, стриминговое телевидение и каталог фильмов.  
Информация: база персональных данных клиентов оператора, состоящая из следующих таблиц:  
 * `contract.csv` — информация о договоре;  
 * `personal.csv` — персональные данные клиента;  
 * `internet.csv` — информация об интернет-услугах;  
 * `phone.csv` — информация об услугах телефонии.  
Таблицы связаны между собой по столбцам customerID с уникальными ID клиентов.  

**Ключевые шаги в решении задачи:**

1. Анализ данных с целью подготовки датасета к обучению (обработка пропусков, аномалий, дубликатов).  
2. Анализ данных для понимания, какие признаки можно и нужно использовать для обучения моделей, а какие нет, а также какие признаки можно создать дополнительно на основе уже имеющихся данных. Создание новых признаков.  
3. Анализ данных с целью выявления взаимосвязи между признаками, нахождение мультиколинеарности.  
4. Подготовка датасета к обучению: разделение на выборки, кодирование категориальных признаков с помощью OneHotEncoder, масштабирование количественных признаков с помощью StandardScaler (в процессе обучения через Pipeline для избежания утечки признаков на кросс-валидации).    
5. Выбор моделей для обучения, определение диапазонов гиперпараметров для последующего подбора оптимальных.  
6. Обучение моделей с подбором гиперпараметров: создание объектов Pipeline  с 2мя шагами (масштабирование через StndardScaler и создание модели), подбор гиперпараметров и расчет метрики ROC AUC с помощью GridSearchCV.  
7. Анализ полученных на разных моделях результатов, выбор лучшей модели с лучшими гиперпараметрами по максимальному значению метрики ROC AUC и проверка её работоспособности на тестовой выборке.

**Результат**

Для прогнозирования были построены модели машинного обучения на основе алгоритмов Logistic Regression, Decision Tree, Random Forest, LGBM, CatBoost.   
Максимальное значение метрики ROC AUC (0.93303) было получено с помощью модели на базе CatBoost с подобранными гиперпараметрами clf__iterations = 1000, clf__learning_rate = 0.7, clf__max_depth = 2.  
На тестовой выборке величина метрики составила 0.94152, что соответствует поставленному условию.  
Данная модель предложена к использованию для прогнозирования ухода клиентов на основании данных об их поведении. Такой прогноз может указать менеджерам на то, каким клиентам нужно уделить особое внимание: провести опрос об удовлетворённости качеством обслуживания, предложить более интересные тарифы.  

**Используемые библиотеки и технологии:**  
* pandas
* numpy
* datetime
* matplotlib
* seaborn
* sklearn
* catboost
* lightgbm
* random forest
* logistic regression
* StndardScaler
* OneHotEncoder
* GridSearchCV
* Pipeline

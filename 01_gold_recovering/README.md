**Описание задачи**  

Подготовить прототип модели машинного обучения, предсказывающей коэффициент восстановления золота из золотосодержащей руды.  
Требования к модели: минимальное значение метрики sMAPE, полученной расчётным путём.   

**Описание технологического процесса**

Технологический процесс обогащения руды включает следующие этапы:
1. rougher — флотация
2. primary_cleaner — первичная очистка
3. secondary_cleaner — вторичная очистка
4. final — финальные характеристики. 

Типы параметров:
1. input — параметры сырья
2. output — параметры продукта
3. state — параметры, характеризующие текущее состояние этапа
4. calculation — расчётные характеристики

Параметры этапов:
1. air amount — объём воздуха
2. fluid levels — уровень жидкости
3. feed size — размер гранул сырья
4. feed rate — скорость подачи

Прочие обозначения:
1. rougher feed — исходное сырье
2. rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
* xanthate — ксантогенат (промотер, или активатор флотации);
* sulphate — сульфат (на данном производстве сульфид натрия);
* depressant — депрессант (силикат натрия).
3. rougher tails — отвальные хвосты
4. floatbanks — флотационная установка
5. rougher Au — черновой концентрат золота
6. final Au — финальный концентрат золота

Для оценки эффективности технологического процесса используется показатель эффективности обогащения:  
$recovery = \frac{C\times(F-T)}{F\times(C-T)}$,  
где:  
C — доля золота в концентрате после флотации/очистки;  
F — доля золота в сырье/концентрате до флотации/очистки;  
T — доля золота в отвальных хвостах после флотации/очистки.   

Для оценки эффективности модели используется метрика sMAPE (симметричное среднее абсолютное процентное отклонение):  
$sMAPE = \frac{1}{N}\sum_{i=1}^N\frac{|y_i - \hat y_i|}{(|y_i| + |\hat y_i|)/2}\times 100%$,  
где:  
$y_i$ - целевое значение признака с индексом i  
$\hat y_i$ - значение предсказания признака с индексом i  
N - количество наблюдений в выборке

**Источник данных** 

База с историческими данными компании, представляющими собой  показатели различных датчиков на разных этапах процесса обогащения руды в определённый период времени (шаг - 1 час).  
Данные предствлены в виде трёх датасетов:
* gold_recovery_train_new.csv — обучающая выборка;
* gold_recovery_test_new.csv — тестовая выборка;
* gold_recovery_full_new.csv — исходные данные.
Данные индексируются датой и временем получения информации (признак date).
Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков.

**Ключевые шаги в решении задачи:**

1. Анализ данных с целью подготовки датасета к обучению (обработка пропусков, аномалий, дубликатов).  
2. Анализ данных с целью изучения изменения показателей в процессе обогащения, а также подтверждения несущественных различий между тестовой и обучающей выборками.  
3. Подготовка датасета к обучению: удаление лишних признаков, подготовка функций для расчёта sMAPE (промежуточных и общей).  
4. Выбор моделей для обучения, определение диапазонов гиперпараметров для последующего подбора оптимальных.  
5. Анализ полученных на разных моделях результатов, выбор лучшей модели с лучшими гиперпараметрами по минимальному значению метрики sMAPE и проверка её работоспособности на тестовой выборке.

**Результат**

Для прогнозирования были построены модели машинного обучения (отдельно для процесса флотации, отдельно для процесса обогащения) на основе алгоритмов Linear Regression, Decision Tree, Random Forest, Bagging.   
Минимальное значение метрики sMAPE (0.103) было получено с помощью модели на базе Linear Regression с подобранными гиперпараметрами copy_X = True, fit_intercept = True, normalize = True.  
На тестовой выборке величина метрики составила 0,099.  
Данная модель предложена для прогнозирования коэффициента восстановления золота из руды. Такой прогноз может сигнализировать о том, что производственных процесс необходимо остановить, т.к. содержание золота в руде недостаточно, что позволит сэкономить ресурсы и время.  

**Используемые библиотеки и технологии:**  
* pandas
* numpy
* matplotlib
* seaborn
* sklearn
* GridSearchCV
* random forest
* decision tree
* linear regression
* bagging
* bootstrap
